[
  {
    "name": "From Kindle to Gmail!",
    "handle": "highlights",
    "date": "2025-12-14",
    "body_html": "<h1>From Kindle to Gmail: Building My Own Readwise-Like System on AWS</h1>\n<p>I've always adored <strong>Readwise</strong> the app resurfacing your book highlights so they stick. </p>\n<p><strong>The Magic Result:</strong> Pure automation joy! Every day 5 random highlights in to my mailbox.</p>\n<h3>The Journey: Practicing AWS, and Linux to Event-Driven Automation</h3>\n<p>Roadmap <strong>Kindle → Ubuntu → S3 → Lambda → Email</strong>.</p>\n<ol>\n<li>Write sync_kindle.sh, schedule with udev,</li>\n<li>Install AWS CLI, configure with IAM keys.</li>\n<li>Create S3 bucket, test upload.</li>\n<li>Write lambda_function.py, zip, create Lambda with IAM role (AWSLambdaBasicExecutionRole, AmazonS3ReadOnlyAccess, AmazonSNSFullAccess).</li>\n<li>Set CloudWatch rule, link to Lambda.</li>\n<li>Create SNS topic, subscribe email, update Lambda to publish.</li>\n<li>Test: aws lambda invoke ..., check email.</li>\n</ol>\n<p><strong>Version 1 (Cron + Daily):</strong> Script polled every 5 mins.</p>\n<p>In the first project I used cron:</p>\n<div class=\"codehilite\"><pre><span></span><code>crontab<span class=\"w\"> </span>-e\n</code></pre></div>\n\n<div class=\"codehilite\"><pre><span></span><code>*/5 * * * * ~/kindle_highlights/sync_kindle.sh\n</code></pre></div>\n\n<p>But what I wanted to try is a different way. To get synchronization only when the Kindle is plugged. the udev is ideal for it.</p>\n<p><strong>Version 2 (mount trigged):</strong> Switched to <strong>udev</strong> for event-driven trigger on plug-in. </p>\n<h3>Deep Dive: How It Works</h3>\n<ol>\n<li><strong>Instant Trigger: udev Detects Kindle Plug-In</strong></li>\n<li>Ubuntu auto-mounts at <code>/media/$USER/Kindle</code>.</li>\n<li>udev runs script <strong>once</strong> when partition appears.</li>\n</ol>\n<p><strong>Discovery Commands</strong>\n   <code>bash\n   lsblk                  # Spot the Kindle mount\n   lsusb                  # Find \"1949:xxxx\" (Amazon vendor ID)\n   lsusb -v | grep -E 'idVendor|idProduct'  # Detailed IDs\n   udevadm monitor --environment --udev    # Live debug events</code></p>\n<p><strong>hint</strong>: amazon kindle division is Lab126 and their official vendor is 1949, it’s easier when you know what you are searching for.</p>\n<p><strong>hint</strong>: check if the Kindle is mounted, because I have only charged cables as well, these cannot transfer data.</p>\n<p><strong>udev Rule</strong>\n   <code>bash\n   sudo nano /etc/udev/rules.d/99-kindle-sync.rules</code></p>\n<p><code>bash\n   ACTION==\"add\", SUBSYSTEM==\"block\", ENV{ID_VENDOR_ID}==\"1949\", ENV{ID_MODEL_ID}==\"0324\", \\\n     ENV{ID_FS_USAGE}==\"filesystem\", ENV{ID_FS_TYPE}==\"vfat\", ENV{DEVTYPE}==\"partition\", \\\n     RUN+=\"/bin/bash /home/$USER/kindle_highlights/run_sync_when_kindle_arrives.sh\"</code></p>\n<p>Reload:\n   <code>bash\n   sudo udevadm control --reload-rules &amp;&amp; sudo udevadm trigger</code></p>\n<ol>\n<li><strong>Wrapper &amp; Main Script</strong>\n   Wrapper for udev iscreated to simplify the execution of specific action when certain device events occur:</li>\n</ol>\n<p>```bash\n   #!/bin/bash\n   # ~/kindle_highlights/run_sync_when_kindle_arrives.sh</p>\n<p>exec sudo -u $USER /bin/bash /home/$USER/kindle_highlights/sync_kindle.sh \\\n     &gt;&gt; /home/$USER/kindle_highlights/sync_log.txt 2&gt;&amp;1\n   ```</p>\n<p>Main script:</p>\n<p>```bash\n    #!/bin/bash\n    set -euo pipefail</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"n\">KINDLE_MOUNT</span><span class=\"o\">=</span><span class=\"s2\">&quot;/media/wolsky/Kindle&quot;</span>\n<span class=\"n\">SOURCE</span><span class=\"o\">=</span><span class=\"s2\">&quot;${KINDLE_MOUNT}/documents/My Clippings.txt&quot;</span>\n<span class=\"n\">DEST_DIR</span><span class=\"o\">=</span><span class=\"s2\">&quot;/home/wolsky/kindle_highlights&quot;</span>\n<span class=\"n\">TIMESTAMP</span><span class=\"o\">=$</span><span class=\"p\">(</span><span class=\"n\">date</span><span class=\"w\"> </span><span class=\"o\">+%</span><span class=\"n\">Y</span><span class=\"o\">%</span><span class=\"n\">m</span><span class=\"o\">%</span><span class=\"n\">d_</span><span class=\"o\">%</span><span class=\"n\">H</span><span class=\"o\">%</span><span class=\"n\">M</span><span class=\"o\">%</span><span class=\"n\">S</span><span class=\"p\">)</span>\n\n<span class=\"n\">DEST</span><span class=\"o\">=</span><span class=\"s2\">&quot;${DEST_DIR}/My_Clippings_${TIMESTAMP}.txt&quot;</span><span class=\"w\">          </span><span class=\"c1\"># Raw history</span>\n<span class=\"n\">LOG</span><span class=\"o\">=</span><span class=\"s2\">&quot;${DEST_DIR}/sync_log.txt&quot;</span>\n\n\n<span class=\"n\">S3_KEY</span><span class=\"o\">=</span><span class=\"s2\">&quot;My Clippings.txt&quot;</span>\n<span class=\"n\">S3_BUCKET</span><span class=\"o\">=</span><span class=\"s2\">&quot;s3://wolsky-cytaty&quot;</span>\n\n<span class=\"nb\">log</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"n\">echo</span><span class=\"w\"> </span><span class=\"s2\">&quot;[$(date &#39;+%Y-%m-</span><span class=\"si\">%d</span><span class=\"s2\"> %H:%M:%S&#39;)] $*&quot;</span><span class=\"w\"> </span><span class=\"o\">&gt;&gt;</span><span class=\"w\"> </span><span class=\"s2\">&quot;$LOG&quot;</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n\n<span class=\"c1\"># Prevent double execution</span>\n<span class=\"p\">[[</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"s2\">&quot;$DEST_DIR/.sync.lock&quot;</span><span class=\"w\"> </span><span class=\"p\">]]</span><span class=\"w\"> </span><span class=\"o\">&amp;&amp;</span><span class=\"w\"> </span><span class=\"n\">exit</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"n\">touch</span><span class=\"w\"> </span><span class=\"s2\">&quot;$DEST_DIR/.sync.lock&quot;</span>\n<span class=\"n\">trap</span><span class=\"w\"> </span><span class=\"s1\">&#39;rm -f &quot;$DEST_DIR/.sync.lock&quot;&#39;</span><span class=\"w\"> </span><span class=\"n\">EXIT</span>\n\n<span class=\"k\">if</span><span class=\"w\"> </span><span class=\"p\">[[</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"s2\">&quot;$SOURCE&quot;</span><span class=\"w\"> </span><span class=\"p\">]];</span><span class=\"w\"> </span><span class=\"n\">then</span>\n<span class=\"w\">    </span><span class=\"c1\"># Raw backup</span>\n<span class=\"w\">    </span><span class=\"n\">cp</span><span class=\"w\"> </span><span class=\"s2\">&quot;$SOURCE&quot;</span><span class=\"w\"> </span><span class=\"s2\">&quot;$DEST&quot;</span>\n<span class=\"w\">    </span><span class=\"nb\">log</span><span class=\"w\"> </span><span class=\"s2\">&quot;Saved raw copy: $DEST&quot;</span>\n\n<span class=\"w\">    </span><span class=\"c1\"># Clean and upload</span>\n<span class=\"w\">    </span><span class=\"n\">CLEANED</span><span class=\"o\">=</span><span class=\"s2\">&quot;${DEST_DIR}/My_Clippings_clean.txt&quot;</span>\n<span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"o\">~/</span><span class=\"n\">kindle_highlights</span><span class=\"o\">/</span><span class=\"n\">clean_clippings</span><span class=\"o\">.</span><span class=\"n\">py</span><span class=\"w\"> </span><span class=\"s2\">&quot;$SOURCE&quot;</span><span class=\"w\"> </span><span class=\"s2\">&quot;$CLEANED&quot;</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">then</span>\n<span class=\"w\">        </span><span class=\"nb\">log</span><span class=\"w\"> </span><span class=\"s2\">&quot;Successfully cleaned clippings&quot;</span>\n\n<span class=\"w\">        </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">aws</span><span class=\"w\"> </span><span class=\"n\">s3</span><span class=\"w\"> </span><span class=\"n\">cp</span><span class=\"w\"> </span><span class=\"s2\">&quot;$CLEANED&quot;</span><span class=\"w\"> </span><span class=\"s2\">&quot;${S3_BUCKET}/${S3_KEY}&quot;</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">only</span><span class=\"o\">-</span><span class=\"n\">show</span><span class=\"o\">-</span><span class=\"n\">errors</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">then</span>\n<span class=\"w\">            </span><span class=\"nb\">log</span><span class=\"w\"> </span><span class=\"s2\">&quot;Uploaded cleaned version → Lambda will send polished highlights&quot;</span>\n<span class=\"w\">        </span><span class=\"k\">else</span>\n<span class=\"w\">            </span><span class=\"nb\">log</span><span class=\"w\"> </span><span class=\"s2\">&quot;S3 upload failed (cleaned file)&quot;</span>\n<span class=\"w\">        </span><span class=\"n\">fi</span>\n<span class=\"w\">    </span><span class=\"k\">else</span>\n<span class=\"w\">        </span><span class=\"nb\">log</span><span class=\"w\"> </span><span class=\"s2\">&quot;Cleaning failed — uploading raw version as fallback&quot;</span>\n<span class=\"w\">        </span><span class=\"n\">aws</span><span class=\"w\"> </span><span class=\"n\">s3</span><span class=\"w\"> </span><span class=\"n\">cp</span><span class=\"w\"> </span><span class=\"s2\">&quot;$SOURCE&quot;</span><span class=\"w\"> </span><span class=\"s2\">&quot;${S3_BUCKET}/${S3_KEY}&quot;</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">only</span><span class=\"o\">-</span><span class=\"n\">show</span><span class=\"o\">-</span><span class=\"n\">errors</span><span class=\"w\"> </span><span class=\"o\">&amp;&amp;</span><span class=\"w\"> </span>\\\n<span class=\"w\">        </span><span class=\"nb\">log</span><span class=\"w\"> </span><span class=\"s2\">&quot;Uploaded raw version&quot;</span>\n<span class=\"w\">    </span><span class=\"n\">fi</span>\n<span class=\"k\">else</span>\n<span class=\"w\">    </span><span class=\"nb\">log</span><span class=\"w\"> </span><span class=\"s2\">&quot;Kindle not mounted or My Clippings.txt not found&quot;</span>\n<span class=\"n\">fi</span>\n<span class=\"err\">```</span>\n</code></pre></div>\n\n<h3>Bonus: Clean Highlights</h3>\n<p>Remove short/empty ones:</p>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"ch\">#!/usr/bin/env python3</span>\n\n<span class=\"c1\"># ~/kindle_highlights/clean_clippings.py</span>\n<span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">pathlib</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">Path</span>\n\n<span class=\"k\">def</span><span class=\"w\"> </span><span class=\"nf\">clean</span><span class=\"p\">(</span><span class=\"n\">input_path</span><span class=\"p\">,</span> <span class=\"n\">output_path</span><span class=\"p\">):</span>\n    <span class=\"n\">content</span> <span class=\"o\">=</span> <span class=\"n\">input_path</span><span class=\"o\">.</span><span class=\"n\">read_text</span><span class=\"p\">(</span><span class=\"n\">encoding</span><span class=\"o\">=</span><span class=\"s1\">&#39;utf-8&#39;</span><span class=\"p\">)</span>\n    <span class=\"n\">entries</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">e</span><span class=\"o\">.</span><span class=\"n\">strip</span><span class=\"p\">()</span> <span class=\"k\">for</span> <span class=\"n\">e</span> <span class=\"ow\">in</span> <span class=\"n\">content</span><span class=\"o\">.</span><span class=\"n\">split</span><span class=\"p\">(</span><span class=\"s1\">&#39;==========&#39;</span><span class=\"p\">)</span> <span class=\"k\">if</span> <span class=\"n\">e</span><span class=\"o\">.</span><span class=\"n\">strip</span><span class=\"p\">()]</span>\n    <span class=\"n\">cleaned</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n    <span class=\"k\">for</span> <span class=\"n\">entry</span> <span class=\"ow\">in</span> <span class=\"n\">entries</span><span class=\"p\">:</span>\n        <span class=\"n\">lines</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">l</span><span class=\"o\">.</span><span class=\"n\">strip</span><span class=\"p\">()</span> <span class=\"k\">for</span> <span class=\"n\">l</span> <span class=\"ow\">in</span> <span class=\"n\">entry</span><span class=\"o\">.</span><span class=\"n\">splitlines</span><span class=\"p\">()</span> <span class=\"k\">if</span> <span class=\"n\">l</span><span class=\"o\">.</span><span class=\"n\">strip</span><span class=\"p\">()]</span>\n        <span class=\"k\">if</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">lines</span><span class=\"p\">)</span> <span class=\"o\">&lt;</span> <span class=\"mi\">3</span><span class=\"p\">:</span> <span class=\"k\">continue</span>\n        <span class=\"n\">text</span> <span class=\"o\">=</span> <span class=\"s1\">&#39; &#39;</span><span class=\"o\">.</span><span class=\"n\">join</span><span class=\"p\">(</span><span class=\"n\">lines</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">:])</span><span class=\"o\">.</span><span class=\"n\">strip</span><span class=\"p\">()</span>\n        <span class=\"k\">if</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">text</span><span class=\"p\">)</span> <span class=\"o\">&lt;</span> <span class=\"mi\">15</span><span class=\"p\">:</span> <span class=\"k\">continue</span>\n        <span class=\"n\">cleaned</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"s1\">&#39;</span><span class=\"se\">\\n</span><span class=\"s1\">&#39;</span><span class=\"o\">.</span><span class=\"n\">join</span><span class=\"p\">(</span><span class=\"n\">lines</span><span class=\"p\">)</span> <span class=\"o\">+</span> <span class=\"s1\">&#39;</span><span class=\"se\">\\n</span><span class=\"s1\">==========</span><span class=\"se\">\\n</span><span class=\"s1\">&#39;</span><span class=\"p\">)</span>\n    <span class=\"n\">output_path</span><span class=\"o\">.</span><span class=\"n\">write_text</span><span class=\"p\">(</span><span class=\"s1\">&#39;&#39;</span><span class=\"o\">.</span><span class=\"n\">join</span><span class=\"p\">(</span><span class=\"n\">cleaned</span><span class=\"p\">),</span> <span class=\"n\">encoding</span><span class=\"o\">=</span><span class=\"s1\">&#39;utf-8&#39;</span><span class=\"p\">)</span>\n\n<span class=\"k\">if</span> <span class=\"vm\">__name__</span> <span class=\"o\">==</span> <span class=\"s1\">&#39;__main__&#39;</span><span class=\"p\">:</span>\n    <span class=\"n\">clean</span><span class=\"p\">(</span><span class=\"n\">Path</span><span class=\"p\">(</span><span class=\"n\">sys</span><span class=\"o\">.</span><span class=\"n\">argv</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]),</span> <span class=\"n\">Path</span><span class=\"p\">(</span><span class=\"n\">sys</span><span class=\"o\">.</span><span class=\"n\">argv</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">]))</span>\n</code></pre></div>\n\n<ol>\n<li>Install AWS CLI on Ubuntu\nInstalled AWS CLI manually since apt failed.</li>\n</ol>\n<div class=\"codehilite\"><pre><span></span><code>sudo<span class=\"w\"> </span>apt<span class=\"w\"> </span>update<span class=\"w\"> </span><span class=\"o\">&amp;&amp;</span><span class=\"w\"> </span>sudo<span class=\"w\"> </span>apt<span class=\"w\"> </span>install<span class=\"w\"> </span>-y<span class=\"w\"> </span>unzip<span class=\"w\"> </span>curl\ncurl<span class=\"w\"> </span><span class=\"s2\">&quot;https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip&quot;</span><span class=\"w\"> </span>-o<span class=\"w\"> </span><span class=\"s2\">&quot;awscliv2.zip&quot;</span>\nunzip<span class=\"w\"> </span>awscliv2.zip\nsudo<span class=\"w\"> </span>./aws/install\naws<span class=\"w\"> </span>--version\nrm<span class=\"w\"> </span>-rf<span class=\"w\"> </span>awscliv2.zip<span class=\"w\"> </span>aws\n</code></pre></div>\n\n<p><strong>Crucial</strong>: Configured credentials:</p>\n<div class=\"codehilite\"><pre><span></span><code>aws<span class=\"w\"> </span>configure\n<span class=\"c1\"># Access Key ID: [from IAM]</span>\n<span class=\"c1\"># Secret Access Key: [from IAM]</span>\n<span class=\"c1\"># Region: us-east-1</span>\n<span class=\"c1\"># Output: json</span>\n</code></pre></div>\n\n<h2><strong>Cloud Flow: S3 → Lambda → SNS</strong></h2>\n<div class=\"codehilite\"><pre><span></span><code>Architecture:\n![](/assets/aws-draw.png)\n</code></pre></div>\n\n<ol>\n<li>Set Up S3 Bucket</li>\n</ol>\n<p>Created wolsky-cytaty bucket </p>\n<div class=\"codehilite\"><pre><span></span><code>aws<span class=\"w\"> </span>s3<span class=\"w\"> </span>mb<span class=\"w\"> </span>s3://wolsky-cytaty/<span class=\"w\"> </span>--region<span class=\"w\"> </span>us-east-1\n</code></pre></div>\n\n<ol>\n<li>Create Lambda Function\nWrote lambda_function.py to pick 5 highlights.</li>\n</ol>\n<div class=\"codehilite\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"nn\">boto3</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"nn\">random</span>\n\n<span class=\"n\">s3</span> <span class=\"o\">=</span> <span class=\"n\">boto3</span><span class=\"o\">.</span><span class=\"n\">client</span><span class=\"p\">(</span><span class=\"s1\">&#39;s3&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">sns</span> <span class=\"o\">=</span> <span class=\"n\">boto3</span><span class=\"o\">.</span><span class=\"n\">client</span><span class=\"p\">(</span><span class=\"s1\">&#39;sns&#39;</span><span class=\"p\">)</span>\n\n<span class=\"k\">def</span><span class=\"w\"> </span><span class=\"nf\">lambda_handler</span><span class=\"p\">(</span><span class=\"n\">event</span><span class=\"p\">,</span> <span class=\"n\">context</span><span class=\"p\">):</span>\n    <span class=\"n\">bucket</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;wolsky-cytaty&#39;</span>\n    <span class=\"n\">key</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;My Clippings.txt&#39;</span>\n    <span class=\"n\">obj</span> <span class=\"o\">=</span> <span class=\"n\">s3</span><span class=\"o\">.</span><span class=\"n\">get_object</span><span class=\"p\">(</span><span class=\"n\">Bucket</span><span class=\"o\">=</span><span class=\"n\">bucket</span><span class=\"p\">,</span> <span class=\"n\">Key</span><span class=\"o\">=</span><span class=\"n\">key</span><span class=\"p\">)</span>\n    <span class=\"n\">content</span> <span class=\"o\">=</span> <span class=\"n\">obj</span><span class=\"p\">[</span><span class=\"s1\">&#39;Body&#39;</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">read</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"n\">decode</span><span class=\"p\">(</span><span class=\"s1\">&#39;utf-8&#39;</span><span class=\"p\">)</span>\n    <span class=\"n\">highlights</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">h</span><span class=\"o\">.</span><span class=\"n\">strip</span><span class=\"p\">()</span> <span class=\"k\">for</span> <span class=\"n\">h</span> <span class=\"ow\">in</span> <span class=\"n\">content</span><span class=\"o\">.</span><span class=\"n\">split</span><span class=\"p\">(</span><span class=\"s1\">&#39;==========&#39;</span><span class=\"p\">)</span> <span class=\"k\">if</span> <span class=\"n\">h</span><span class=\"o\">.</span><span class=\"n\">strip</span><span class=\"p\">()]</span>\n    <span class=\"n\">five</span> <span class=\"o\">=</span> <span class=\"n\">random</span><span class=\"o\">.</span><span class=\"n\">sample</span><span class=\"p\">(</span><span class=\"n\">highlights</span><span class=\"p\">,</span> <span class=\"n\">k</span><span class=\"o\">=</span><span class=\"nb\">min</span><span class=\"p\">(</span><span class=\"mi\">5</span><span class=\"p\">,</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">highlights</span><span class=\"p\">)))</span>\n    <span class=\"n\">message</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;</span><span class=\"se\">\\n\\n</span><span class=\"s1\">&#39;</span><span class=\"o\">.</span><span class=\"n\">join</span><span class=\"p\">(</span><span class=\"n\">five</span><span class=\"p\">)</span>\n\n    <span class=\"n\">sns</span><span class=\"o\">.</span><span class=\"n\">publish</span><span class=\"p\">(</span>\n        <span class=\"n\">TopicArn</span><span class=\"o\">=</span><span class=\"s1\">&#39;arn:aws:sns:us-east-1:123456789:DailyHighlights&#39;</span><span class=\"p\">,</span>\n        <span class=\"n\">Message</span><span class=\"o\">=</span><span class=\"n\">message</span><span class=\"p\">,</span>\n        <span class=\"n\">Subject</span><span class=\"o\">=</span><span class=\"s1\">&#39;Do you remember this?&#39;</span>\n    <span class=\"p\">)</span>\n</code></pre></div>\n\n<ol>\n<li>Lambda</li>\n</ol>\n<p>Every service in the automations needs a Lambda ARN.</p>\n<ul>\n<li>CloudWatch Events needs a target</li>\n<li>Permissions need a function name</li>\n<li>Testing needs a deployed function</li>\n</ul>\n<div class=\"codehilite\"><pre><span></span><code>aws<span class=\"w\"> </span>lambda<span class=\"w\"> </span>create-function<span class=\"w\"> </span><span class=\"se\">\\</span>\n<span class=\"w\">  </span>--function-name<span class=\"w\"> </span>sendRandomHighlight<span class=\"w\"> </span><span class=\"se\">\\</span>\n<span class=\"w\">  </span>--runtime<span class=\"w\"> </span>python3.13<span class=\"w\"> </span><span class=\"se\">\\</span>\n<span class=\"w\">  </span>--handler<span class=\"w\"> </span>lambda_function.lambda_handler<span class=\"w\"> </span><span class=\"se\">\\</span>\n<span class=\"w\">  </span>--role<span class=\"w\"> </span>arn:aws:iam::YOUR_ACCOUNT_ID:role/lambda-s3-role<span class=\"w\"> </span><span class=\"se\">\\</span>\n<span class=\"w\">  </span>--zip-file<span class=\"w\"> </span>fileb://function.zip\n</code></pre></div>\n\n<ul>\n<li>Create = define infrastructure</li>\n<li>Update = iterate on logic</li>\n</ul>\n<div class=\"codehilite\"><pre><span></span><code>aws<span class=\"w\"> </span>lambda<span class=\"w\"> </span>update-function-code<span class=\"w\"> </span>--function-name<span class=\"w\"> </span>sendRandomHighlight<span class=\"w\"> </span>--zip-file<span class=\"w\"> </span>fileb://function.zip\n</code></pre></div>\n\n<ol>\n<li>Test:</li>\n</ol>\n<div class=\"codehilite\"><pre><span></span><code>aws<span class=\"w\"> </span>lambda<span class=\"w\"> </span>invoke<span class=\"w\"> </span>--function-name<span class=\"w\"> </span>sendRandomHighlight<span class=\"w\"> </span>--payload<span class=\"w\"> </span><span class=\"s1\">&#39;{}&#39;</span><span class=\"w\"> </span>output.json.\n</code></pre></div>\n\n<ol>\n<li>: Schedule with CloudWatch</li>\n</ol>\n<p>What: Set daily trigger.</p>\n<div class=\"codehilite\"><pre><span></span><code>aws<span class=\"w\"> </span>events<span class=\"w\"> </span>put-rule<span class=\"w\"> </span>--name<span class=\"w\"> </span>DailyHighlightTrigger<span class=\"w\"> </span>--schedule-expression<span class=\"w\"> </span><span class=\"s1\">&#39;rate(1 day)&#39;</span>\n</code></pre></div>\n\n<div class=\"codehilite\"><pre><span></span><code>aws<span class=\"w\"> </span>lambda<span class=\"w\"> </span>add-permission<span class=\"w\"> </span><span class=\"se\">\\</span>\n<span class=\"w\">  </span>--function-name<span class=\"w\"> </span>sendRandomHighlight<span class=\"w\"> </span><span class=\"se\">\\</span>\n<span class=\"w\">  </span>--statement-id<span class=\"w\"> </span>CloudWatchTrigger<span class=\"w\"> </span><span class=\"se\">\\</span>\n<span class=\"w\">  </span>--action<span class=\"w\"> </span><span class=\"s1\">&#39;lambda:InvokeFunction&#39;</span><span class=\"w\"> </span><span class=\"se\">\\</span>\n<span class=\"w\">  </span>--principal<span class=\"w\"> </span>events.amazonaws.com<span class=\"w\"> </span><span class=\"se\">\\</span>\n<span class=\"w\">  </span>--source-arn<span class=\"w\"> </span>arn:aws:events:us-east-1:YOUR_ACCOUNT_ID:rule/DailyHighlightTrigger\n</code></pre></div>\n\n<div class=\"codehilite\"><pre><span></span><code>aws<span class=\"w\"> </span>events<span class=\"w\"> </span>put-targets<span class=\"w\"> </span><span class=\"se\">\\</span>\n<span class=\"w\">  </span>--rule<span class=\"w\"> </span>DailyHighlightTrigger<span class=\"w\"> </span><span class=\"se\">\\</span>\n<span class=\"w\">  </span>--targets<span class=\"w\"> </span><span class=\"s1\">&#39;[{&quot;Id&quot;: &quot;1&quot;, &quot;Arn&quot;: &quot;arn:aws:lambda:us-east-1:YOUR_ACCOUNT_ID:function:sendRandomHighlight&quot;}]&#39;</span>\n</code></pre></div>\n\n<ol>\n<li>Set Up SNS for Email</li>\n</ol>\n<p>What: Added email notifications.</p>\n<p>```bash\naws sns subscribe \\\n  --topic-arn arn:aws:sns:us-east-1:YOUR_ACCOUNT_ID:DailyHighlights \\\n  --protocol email \\\n  --notification-endpoint your_email@gmail.com</p>\n<p>This project taught Linux automation, event-driven design, and cloud basics. </p>"
  },
  {
    "name": "Hello Mars!",
    "handle": "hello-mars",
    "date": "2025-12-07",
    "body_html": "<h1>Hello Mars!</h1>\n<p>This is my <strong>first</strong> blog post. More is coming soon!</p>"
  }
]